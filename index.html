<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WS Amply Simulator</title>
    <link rel="stylesheet" href="app.css">
</head>

<body>
    <div
        class="flex flex-col w-full bg-[url('res/background-1.png')] bg-center bg-cover items-center justify-center overflow-auto">
        <div
            class="flex flex-col items-center justify-center w-full min-h-screen gap-4 px-4 py-6 overflow-auto bg-black/50">
            <div class="flex flex-col items-center">
                <div class="flex flex-col gap-2 max-w-[400px]">

                    <div
                        class="grid grid-cols-2 gap-2 bg-gradient-to-b from-[#5a525a] to-[#423942] text-sm md:text-base px-4 py-2 text-white border-2 border-yellow-400">
                        <div class="flex flex-row items-center gap-2">
                            <span class="text-yellow-400">Gold :</span>
                            <span id="ui_gold_usage">0</span>
                        </div>
                        <div class="flex flex-row items-center gap-2">
                            <span class="text-yellow-400">Sign :</span>
                            <span id="ui_sign_usage">0</span>
                        </div>
                    </div>

                    <!-- // Banner -->
                    <div
                        class="flex flex-col bg-[#735a52] border-2 border-yellow-500 relative shadow-lg text-sm md:text-base">
                        <div
                            class="flex flex-row items-center justify-center px-4 py-2 font-semibold text-yellow-500 bg-orange-800 border-b-2 border-b-orange-600">
                            <span>Item Amplification</span>
                        </div>
                        <div class="flex flex-col bg-[#735a52 text-white p-4 gap-4">
                            <div class="flex flex-row items-center gap-4 font-semibold text-pink-300">
                                <button onclick="showItems()" id="item"
                                    class="w-12 h-12 rounded-md border-4 bg-stone-800 border-[#b59c63]">
                                    <img id="amply_icon" src="res/1-handed-weapon.png" alt=""
                                        class="object-cover object-center">
                                </button>
                                <span id="ui_item_name">Blade of Kingdom of Fortitude</span>
                            </div>
                            <div class="grid items-center grid-cols-2 gap-4 font-semibold text-yellow-400">
                                <div class="flex flex-col gap-2">
                                    <span>Required</span>
                                    <div class="w-12 h-12 rounded-md border-4 bg-stone-800 border-[#b59c63]">
                                        <img src="res/sphere-damage.png" alt="" class="items-center object-center">
                                    </div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <span>Level</span>
                                    <div id="amply_point" class="grid grid-cols-5 gap-2">
                                        <span class="w-5 h-5 rounded-full bg-slate-400/80"></span>
                                        <span class="w-5 h-5 rounded-full bg-slate-400/80"></span>
                                        <span class="w-5 h-5 rounded-full bg-slate-400/80"></span>
                                        <span class="w-5 h-5 rounded-full bg-slate-400/80"></span>
                                        <span class="w-5 h-5 rounded-full bg-slate-400/80"></span>
                                        <span class="w-5 h-5 rounded-full bg-slate-400/80"></span>
                                        <span class="w-5 h-5 rounded-full bg-slate-400/80"></span>
                                        <span class="w-5 h-5 rounded-full bg-slate-400/80"></span>
                                        <span class="w-5 h-5 rounded-full bg-slate-400/80"></span>
                                        <span class="w-5 h-5 rounded-full bg-slate-400/80"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col">
                                <span class="font-semibold text-yellow-400">Item spoiling insurance:</span>
                                <div class="flex flex-col gap-2">
                                    <span class="text-slate-400">No (High chance to spoil)</span>
                                    <span class="text-slate-400">For 59 Miracle Coins</span>
                                    <span>Sign of Imperishability</span>
                                </div>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-2 bg-[#4b3f34] px-2 py-2">
                            <input id="ui_amply_gold_amount" type="text"
                                class="text-white border-4 border-yellow-600 rounded-md bg-[#313129] text-center items-center"
                                value="1000000">
                            <input id="ui_amply_gold_cost" type="text"
                                class="text-white border-4 border-yellow-600 rounded-md bg-[#313129] text-center items-center"
                                value="100">
                        </div>
                        <div class="hidden bg-yellow-500">
                        </div>
                        <div id="container_progressbar"
                            class="absolute top-0 bottom-0 flex flex-col hidden w-full h-10 p-1 my-auto bg-yellow-500 shadow-lg">
                            <div class="flex flex-col w-full h-full bg-[#735a52] rounded-full overflow-hidden">
                                <div id="progressbar" class="w-full h-full transition duration-300 bg-blue-500"
                                    style="width: 0%;"></div>
                            </div>
                        </div>

                        <!-- list Items -->
                        <div id="list_item"
                            class="absolute top-0 bottom-0 left-0 right-0 bg-[#0f2740]/80 flex flex-col overflow-auto text-white hidden">
                            <button onclick="showItems()"
                                class="flex flex-row items-center gap-4 px-6 py-4 border-b border-b-yellow-500/40 hover:bg-blue-600/20">
                                <div class="w-12 h-12 rounded-md border-4 bg-stone-800 border-[#b59c63]">
                                    <img src="res/1-handed-weapon.png" alt="" class="object-cover object-center">
                                </div>
                                <span>Blade of Kingdom of Fortitude</span>
                            </button>
                            <div
                                class="flex flex-row items-center gap-4 px-6 py-4 border-b border-b-yellow-500/40 hover:bg-blue-600/20">
                                <div class="w-12 h-12 rounded-md border-4 bg-stone-800 border-[#b59c63]">
                                    <img src="res/2-handed-weapon.png" alt="" class="object-cover object-center">
                                </div>
                                <span>Blade of Kingdom of Fortitude</span>
                            </div>
                            <div
                                class="flex flex-row items-center gap-4 px-6 py-4 border-b border-b-yellow-500/40 hover:bg-blue-600/20">
                                <div class="w-12 h-12 rounded-md border-4 bg-stone-800 border-[#b59c63]">
                                    <img src="res/ranged-weapon-bow.png" alt="" class="object-cover object-center">
                                </div>
                                <span>Blade of Kingdom of Fortitude</span>
                            </div>
                            <div
                                class="flex flex-row items-center gap-4 px-6 py-4 border-b border-b-yellow-500/40 hover:bg-blue-600/20">
                                <div class="w-12 h-12 rounded-md border-4 bg-stone-800 border-[#b59c63]">
                                    <img src="res/ranged-weapon-crossbow.png" alt="" class="object-cover object-center">
                                </div>
                                <span>Blade of Kingdom of Fortitude</span>
                            </div>
                            <div
                                class="flex flex-row items-center gap-4 px-6 py-4 border-b border-b-yellow-500/40 hover:bg-blue-600/20">
                                <div class="w-12 h-12 rounded-md border-4 bg-stone-800 border-[#b59c63]">
                                    <img src="res/ranged-weapon-staff.png" alt="" class="object-cover object-center">
                                </div>
                                <span>Blade of Kingdom of Fortitude</span>
                            </div>
                            <div
                                class="flex flex-row items-center gap-4 px-6 py-4 border-b border-b-yellow-500/40 hover:bg-blue-600/20">
                                <div class="w-12 h-12 rounded-md border-4 bg-stone-800 border-[#b59c63]">
                                    <img src="res/shield.png" alt="" class="object-cover object-center">
                                </div>
                                <span>Blade of Kingdom of Fortitude</span>
                            </div>

                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-2 text-sm shadow-lg md:text-base">
                        <button onclick="reset()"
                            class="px-4 py-2 font-semibold border-4 border-yellow-200 bg-gradient-to-b from-[#737bb5] to-[#5a5273] text-yellow-300 hover:bg-gradient-to-t hover:from-[#5a5273] hover:to-[#5a5273]">RESET</button>
                        <button onclick="amply()"
                            class="px-4 py-2 font-semibold border-4 border-yellow-200 bg-gradient-to-b from-[#737bb5] to-[#5a5273] text-yellow-300 hover:bg-gradient-to-t hover:from-[#5a5273] hover:to-[#5a5273]">AMPLIFY</button>
                    </div>
                </div>
            </div>
            <div class="flex flex-col items-center justify-center px-4 py-1 text-sm text-white">
                <span class="font-semibold text-center">Warespear Amplification Simulation</span>
                <span class="text-center">Created by Wahyu Hidayat <a
                        href="https://github.com/wahyuhidayattz">https://github.com/wahyuhidayattz</a>
                </span>
            </div>
        </div>
    </div>

    </div>
    <script src="items.js"></script>
    <script>
        let ui_item_name = document.getElementById('ui_item_name');
        let amply_icon = document.getElementById('amply_icon');
        let ui_amply_gold_amount = document.getElementById('ui_amply_gold_amount');
        let ui_amply_gold_cost = document.getElementById('ui_amply_gold_cost');

        let ui_sign_usage = document.getElementById('ui_sign_usage');
        let ui_gold_usage = document.getElementById('ui_gold_usage');
        let item = document.getElementById('item');
        let list_item = document.getElementById('list_item');

        // BASIC VARIABLE
        let item_name = ui_item_name.textContent;
        let base_gold_amount = 1000000;
        let base_gold_cost = 100;
        let base_amply_plus = 0;

        // AMPLY VARIABLE
        let amply_point = document.getElementById('amply_point');
        let amply_awal = 0;
        let amply_random = 1;
        let amply_frac = 1.5;
        let text = "";
        let jumlah = 0;
        let total_base_gold_cost = 0;

        let reset = (name = item_name, cost = 100, frac = amply_frac) => {
            ui_gold_usage.textContent = 0;
            ui_sign_usage.textContent = 0;
            ui_amply_gold_amount.value = 1000000;
            ui_amply_gold_cost.value = cost;
            ui_item_name.textContent = name;

            base_gold_amount = 1000000;
            base_gold_cost = cost;
            base_amply_plus = 0;

            amply_awal = 0;
            amply_random = 1;
            amply_frac = frac;
            jumlah = 0;
            total_base_gold_cost = 0;

            let index = 0;
            for (const i of amply_point.children) {
                amply_point.children[index].classList.remove('!bg-yellow-500');
                amply_point.children[index].classList.remove('bg-sky-500');
                amply_point.children[index].classList.add('bg-slate-400/80');
                index++;
            }
            // console.log('COST : ' + cost + "\n" +
            //     "FRAC : " + frac + "\n" +
            //     "NAME : " + name);
        }

        let setAmplyVariable = (item_name, item_type) => {
            switch (item_type) {
                case 'one-handed-weapon':
                    amply_frac = 1.5;
                    base_gold_cost = 100;
                    break;
                case 'two-handed-weapon':
                    amply_frac = 1.6;
                    base_gold_cost = 100;
                    break;
                case 'ranged-weapon':
                    amply_frac = 1.7;
                    base_gold_cost = 100;
                    break;
                case 'shield':
                    amply_frac = 1.4;
                    base_gold_cost = 100;
                    break;
                default:
                    amply_frac = 1.5;
                    base_gold_cost = 100;
                    break;
            }
            reset(item_name, base_gold_cost, amply_frac);
        }

        let showItems = () => {
            list_item.classList.toggle('hidden');
        }


        let setItem = (name, icon, type) => {
            showItems();
            item_name = name;
            ui_item_name.textContent = name;
            amply_icon.src = icon;
            setAmplyVariable(item_name, type);
        }

        let render_item = '';
        for (const item of items) {
            let name = item.name;
            let icon = item.icon;
            let type = item.type;
            render_item += `<button onclick="setItem('${name}','${icon}','${type}')"
                                class="flex flex-row items-center gap-4 px-6 py-4 border-b border-b-yellow-500/40 hover:bg-blue-600/20">
                                <div class="w-12 h-12 rounded-md border-4 bg-stone-800 border-[#b59c63]">
                                    <img src="${icon}" alt="" class="object-cover object-center">
                                </div>
                                <span>${name}</span>
                            </button>`;
        }

        list_item.innerHTML = render_item;


        let amply = () => {
            if (amply_awal < 10) {
                let random = Math.floor(Math.random() * amply_random) + 1;
                let text = "Amply Gagal";
                total_base_gold_cost += base_gold_cost;
                base_gold_amount = base_gold_amount - base_gold_cost;

                if (random == 1) {
                    amply_random = amply_random * amply_frac;

                    amply_point.children[amply_awal] = amply_point.children[amply_awal].classList.add('!bg-yellow-500');

                    if (amply_awal < 9) {
                        amply_point.children[amply_awal + 1] = amply_point.children[amply_awal + 1].classList.remove('bg-slate-400/80');
                        amply_point.children[amply_awal + 1] = amply_point.children[amply_awal + 1].classList.add('bg-sky-500');
                    }

                    amply_awal++;
                    text = "Amply Berhasil";

                    base_gold_cost = base_gold_cost + Math.floor((base_gold_cost * 0.20));

                    ui_item_name.textContent = "+" + amply_awal + " " + item_name;
                }

                jumlah++;
                console.log("Amply Ke-" + jumlah + " " + text + " : +" + amply_awal);
                console.log("Glod : " + base_gold_amount + ", base_gold_cost : " + base_gold_cost + " , Total base_gold_cost : " + total_base_gold_cost);

                ui_amply_gold_amount.value = base_gold_amount;
                ui_amply_gold_cost.value = base_gold_cost;

                ui_gold_usage.textContent = total_base_gold_cost;
                ui_sign_usage.textContent = jumlah;
            } else {
                console.log("Amply Selesai, sudah Full Power");
            }
        }

    </script>
</body>

</html>